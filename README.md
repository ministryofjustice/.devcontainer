# Development Containers

[![repo standards badge](https://img.shields.io/endpoint?labelColor=231f20&color=005ea5&style=for-the-badge&label=MoJ%20Compliant&url=https%3A%2F%2Foperations-engineering-reports.cloud-platform.service.justice.gov.uk%2Fapi%2Fv1%2Fcompliant_public_repositories%2Fendpoint%2F.devcontainer&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABmJLR0QA/wD/AP+gvaeTAAAHJElEQVRYhe2YeYyW1RWHnzuMCzCIglBQlhSV2gICKlHiUhVBEAsxGqmVxCUUIV1i61YxadEoal1SWttUaKJNWrQUsRRc6tLGNlCXWGyoUkCJ4uCCSCOiwlTm6R/nfPjyMeDY8lfjSSZz3/fee87vnnPu75z3g8/kM2mfqMPVH6mf35t6G/ZgcJ/836Gdug4FjgO67UFn70+FDmjcw9xZaiegWX29lLLmE3QV4Glg8x7WbFfHlFIebS/ANj2oDgX+CXwA9AMubmPNvuqX1SnqKGAT0BFoVE9UL1RH7nSCUjYAL6rntBdg2Q3AgcAo4HDgXeBAoC+wrZQyWS3AWcDSUsomtSswEtgXaAGWlVI2q32BI0spj9XpPww4EVic88vaC7iq5Hz1BvVf6v3qe+rb6ji1p3pWrmtQG9VD1Jn5br+Knmm70T9MfUh9JaPQZu7uLsR9gEsJb3QF9gOagO7AuUTom1LpCcAkoCcwQj0VmJregzaipA4GphNe7w/MBearB7QLYCmlGdiWSm4CfplTHwBDgPHAFmB+Ah8N9AE6EGkxHLhaHU2kRhXc+cByYCqROs05NQq4oR7Lnm5xE9AL+GYC2gZ0Jmjk8VLKO+pE4HvAyYRnOwOH5N7NhMd/WKf3beApYBWwAdgHuCLn+tatbRtgJv1awhtd838LEeq30/A7wN+AwcBt+bwpD9AdOAkYVkpZXtVdSnlc7QI8BlwOXFmZ3oXkdxfidwmPrQXeA+4GuuT08QSdALxC3OYNhBe/TtzON4EziZBXD36o+q082BxgQuqvyYL6wtBY2TyEyJ2DgAXAzcC1+Xxw3RlGqiuJ6vE6QS9VGZ/7H02DDwAvELTyMDAxbfQBvggMAAYR9LR9J2cluH7AmnzuBowFFhLJ/wi7yiJgGXBLPq8A7idy9kPgvAQPcC9wERHSVcDtCfYj4E7gr8BRqWMjcXmeB+4tpbyG2kG9Sl2tPqF2Uick8B+7szyfvDhR3Z7vvq/2yqpynnqNeoY6v7LvevUU9QN1fZ3OTeppWZmeyzRoVu+rhbaHOledmoQ7LRd3SzBVeUo9Wf1DPs9X90/jX8m/e9Rn1Mnqi7nuXXW5+rK6oU7n64mjszovxyvVh9WeDcTVnl5KmQNcCMwvpbQA1xE8VZXhwDXAz4FWIkfnAlcBAwl6+SjD2wTcmPtagZnAEuA3dTp7qyNKKe8DW9UeBCeuBsbsWKVOUPvn+MRKCLeq16lXqLPVFvXb6r25dlaGdUx6cITaJ8fnpo5WI4Wuzcjcqn5Y8eI/1F+n3XvUA1N3v4ZamIEtpZRX1Y6Z/DUK2g84GrgHuDqTehpBCYend94jbnJ34DDgNGArQT9bict3Y3p1ZCnlSoLQb0sbgwjCXpY2blc7llLW1UAMI3o5CD4bmuOlwHaC6xakgZ4Z+ibgSxnOgcAI4uavI27jEII7909dL5VSrimlPKgeQ6TJCZVQjwaOLaW8BfyWbPEa1SaiTH1VfSENd85NDxHt1plA71LKRvX4BDaAKFlTgLeALtliDUqPrSV6SQCBlypgFlbmIIrCDcAl6nPAawmYhlLKFuB6IrkXAadUNj6TXlhDcCNEB/Jn4FcE0f4UWEl0NyWNvZxGTs89z6ZnatIIrCdqcCtRJmcCPwCeSN3N1Iu6T4VaFhm9n+riypouBnepLsk9p6p35fzwvDSX5eVQvaDOzjnqzTl+1KC53+XzLINHd65O6lD1DnWbepPBhQ3q2jQyW+2oDkkAtdt5udpb7W+Q/OFGA7ol1zxu1tc8zNHqXercfDfQIOZm9fR815Cpt5PnVqsr1F51wI9QnzU63xZ1o/rdPPmt6enV6sXqHPVqdXOCe1rtrg5W7zNI+m712Ir+cer4POiqfHeJSVe1Raemwnm7xD3mD1E/Z3wIjcsTdlZnqO8bFeNB9c30zgVG2euYa69QJ+9G90lG+99bfdIoo5PU4w362xHePxl1slMab6tV72KUxDvzlAMT8G0ZohXq39VX1bNzzxij9K1Qb9lhdGe931B/kR6/zCwY9YvuytCsMlj+gbr5SemhqkyuzE8xau4MP865JvWNuj0b1YuqDkgvH2GkURfakly01Cg7Cw0+qyXxkjojq9Lw+vT2AUY+DlF/otYq1Ixc35re2V7R8aTRg2KUv7+ou3x/14PsUBn3NG51S0XpG0Z9PcOPKWSS0SKNUo9Rv2Mmt/G5WpPF6pHGra7Jv410OVsdaz217AbkAPX3ubkm240belCuudT4Rp5p/DyC2lf9mfq1iq5eFe8/lu+K0YrVp0uret4nAkwlB6vzjI/1PxrlrTp/oNHbzTJI92T1qAT+BfW49MhMg6JUp7ehY5a6Tl2jjmVvitF9fxo5Yq8CaAfAkzLMnySt6uz/1k6bPx59CpCNxGfoSKA30IPoH7cQXdArwCOllFX/i53P5P9a/gNkKpsCMFRuFAAAAABJRU5ErkJggg==)](https://operations-engineering-reports.cloud-platform.service.justice.gov.uk/public-report/.devcontainer)

## Contents

- [Benefits of Development Containers](#benefits-of-development-containers)
- [Adding a Development Container to a Project](#adding-a-development-container-to-a-project)
- [What are Features?](#what-are-features)
- [Ministry of Justice Features](#ministry-of-justice-features)
  - [AWS](#aws)
  - [Cloud Platform](#cloud-platform)
  - [Container Structure Tests](#container-structure-tests)
  - [Kubernetes](#kubernetes)
  - [Static Analysis](#static-analysis)
  - [Terraform](#terraform)
- [Creating a New Feature](#creating-a-new-feature)
- [Adding Features to a Development Container](#adding-features-to-a-development-container)
- [Contributing](#contributing)

This repository was created by Ministry of Justice's Dev Container Community of Practice. The goal is to release a foundational image for deployment, develop features that boost developer efficiency, and set a benchmark for using containerised development environments within the Ministry of Justice.
Additionally this repository serves documentation relating to the use and configuration of devcontainers within the Ministry of Justice.

Contact us on our Slack channel - [`#devcontainer-community`](https://moj.enterprise.slack.com/archives/C06DZ4F04JZ).

Official documentation is located [here](https://code.visualstudio.com/docs/devcontainers/create-dev-container).

## Benefits of Development Containers

1. **Consistency Across Environments** - Ensures that every developer in a team/project/product works with the same tools and configurations, reducing compatibility issues.

1. **Isolation from Local Machine** - Keeps project-specific settings and dependencies separate from the local environment, avoiding conflicts.

1. **Simplified Onboarding** - Allows new developers to quickly set up a pre-configured development environment, speeding up the onboarding process.

1. **Reproducibility** - Enhances the reliability of builds and tests across different environments by maintaining consistent settings.

1. **Tool Integration** - Offers seamless integration with development tools for efficient coding, debugging, and execution within the container.

1. **Portability** - Enables developers to move their development environments across machines and platforms easily without reconfiguration.

1. **Ease of Updates** - Facilitates straightforward updates and dependency management by allowing updates to be propagated through container images.

1. **GitHub Codespaces Integration** - Enables developers to access fully configured development environments in the cloud via [GitHub Codespaces](https://github.com/features/codespaces), enhancing flexibility and accessibility.

## Adding a Development Container to a Project

1. Create a `.devcontainer` folder in the root of your project.
1. Add a `devcontainer.json` file to the `.devcontainer` folder.
There are a number of parameters which can be included in a devconatiner.json file, these are noted in detail [here](https://containers.dev/implementors/json_reference/).
1. Populate the `devcontainer.json` file with the required settings:

```json
{
  "name": "devcontainer-example",
  "image": "ghcr.io/ministryofjustice/devcontainer-base:latest"
}
```

In the example above, the `name` parameter specifies the name of the development container, and the `image` parameter specifies the base image for the development container.

The `ghcr.io/ministryofjustice/devcontainer-base` image is an extension of `mcr.microsoft.com/devcontainers/base:ubuntu-24.04`. The enhancements are documented [here](https://github.com/ministryofjustice/.devcontainer/blob/main/images/base/Dockerfile).

## What are Features?

In the context of the Ministry of Justice Development Container community, features are built by the community to satisfy the specific needs of our developers and the challenges they face on a day to day basis.

Features created in the Dev Container community are described [here](https://containers.dev/features) both can be consumed when constructing a Development Container. From this point on, we will refer to these features as "Community Features" and Ministry of Justice feature as "Features".

Features are built using the [.devcontainer](https://github.com/ministryofjustice/.devcontainer/) GitHub repository and are designed to be modular and reusable. This means that features can be combined to create a custom development environment that meets the needs of a specific project or team.

Features are can be used by Sofware Developers and those in Operations Roles to create consistent and reliable development environments for the applications and services they work on.

## Ministry of Justice Features

Features are located in the [features](https://github.com/ministryofjustice/.devcontainer/tree/main/features/src) folder in the Development Container GitHub repository. Each feature is listed below.

### AWS

The AWS feature installs the [AWS CLI](https://aws.amazon.com/cli/) and [AWS SSO CLI](https://github.com/synfinatic/aws-sso-cli) .

### Cloud Platform

The Cloud Platform feature installs the [Cloud Platform CLI](https://user-guide.cloud-platform.service.justice.gov.uk/documentation/getting-started/cloud-platform-cli.html).

### Container Structure Tests

The Container Structure Tests feature installs the [container-structure-test](https://github.com/GoogleContainerTools/container-structure-test) CLI, this tool provides a powerful framework to validate the structure of a container image.

### Kubernetes

The Kubernetes feature installs:

- [kubectl](https://kubernetes.io/docs/reference/kubectl/overview/) - to interact with Kubernetes clusters

- [helm](https://helm.sh/docs/intro/install/) - the package manager for Kubernetes

- [ct](https://github.com/helm/chart-testing) - to lint and test Helm charts


### Static Analysis

The Static Analysis feature installs:

- [checkov](https://www.checkov.io/)

- [trivy](https://aquasecurity.github.io/trivy/v0.51/)

- [terrascan](https://runterrascan.io/)

### Terraform

The Terraform feature installs the [`terraform`](https://developer.hashicorp.com/terraform/cli/commands) CLI.

## Creating a New Feature

To add a new feature:

1. Clone the `.devcontainer` [repository](https://github.com/ministryofjustice/.devcontainer/).
1. Create a new feature in the [.devcontainer](https://github.com/ministryofjustice/.devcontainer/tree/main/features/src) GitHub repository.
1. Add the feature to the Development Container [Features](/documentation/features/features.html) documentation.
1. Add tests for the feature in the [.devcontainer](https://github.com/ministryofjustice/.devcontainer/tree/main/features/test) GitHub repository.

## Adding Features to a Development Container

To consume a feature, add the feature to the `features` array in the `devcontainer.json` file. An example of this is shown below:

```json
{
  "name": "devcontainer-example",
  "image": "ghcr.io/ministryofjustice/devcontainer-base:latest",
  "features": {
    "ghcr.io/devcontainers/features/docker-in-docker:2": {},
    "ghcr.io/ministryofjustice/devcontainer-feature/container-structure-test:0": {},
    "ghcr.io/ministryofjustice/devcontainer-feature/static-analysis:0": {}
  }
}
```

In the example above, the `features` array includes the `docker-in-docker`, `container-structure-test`, and `static-analysis` features. Note that the `docker-in-docker` feature is a community feature, while the other two features are Ministry of Justice features. Both types of features can be consumed in the same way.

## Contributing

The base branch requires all commits to be signed. Learn more about signing commits [here](https://docs.github.com/en/authentication/managing-commit-signature-verification/about-commit-signature-verification).
